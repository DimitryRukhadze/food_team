# Макеты JSON объектов для различных сущностей

Предлагается использовать следующие макеты:

## User

Сущность для зарегистрированного пользователя. 

- `id` - уникальный идентификатор пользователя, можно использовать `chat_id` для присвоения. 
- `joined_on` - дата регистрации, можно хранить в unix time для надеждности.

```json
{
    'id': 0,
    'firstname': '',
    'lastname': '',
    'phone': '',
    'joined_on': 0,
}
```


## Subscription

Сущность для индивидуальной подписки.

- `id` - уникальный идентификатор подписки, автоинкремент?.
- `user_id` - пользователь, которому принадлежит подписка, ссылка на `id` в `User`
- `cousine_type` - тип меню, хорошо бы брать строго из предопределенного набора.
- `allergies` - список аллергий, для фильтрации. В списке значения тоже хорошо бы иметь из предопределенного набора.
- `acquired_on` - дата оформления подписки.
- `expires_on` - дата окончания подписки.

```json
{
    'id': 0,
    'user_id': 0,
    'cousine_type': 'FROM_PREDEFINED_SET',
    'allergies': ['FROM_PREDEFINED_SET'],
    'num_persons': 1,
    'num_servings': 1,
    'acquired_on': 0,
    'expires_on': 0
}
```

## Recipe

Сущность для индивидуального рецепта. Предлагаю не делать подсписки для разных видов меню, а хранить их просто с соотвествующим полем для фильтрации. 

- `id` - уникальный идентификатор подписки, автоинкремент?.
- `name` - название блюда.
- `cousine_type` - тип меню к которому относится, для простоты сопоставления.
- `contains` - список потенциальных алергенов, для фильтрации.
- `calories` - калорийность.
- `steps` - набор шагов для приготовления. Описывается объектом:
  - `title` - заголовок ("Подготовим гранир", "Сделаем соус", и т.п.)
  - `text` - текстовое описание действий в шаге.
  - `ingredients` - список задействованных в шаге продуктов. Описывается объектом:
    - `name` - название продукта.
    - `countable` - можно ли посчитать? Например растительное масло, соль, перец не добавляют по граммовке.
    - `amount` - количество продуктов, для 1 персоны на 1 прием. Это значение перед отображением можно просто умножать по коэффициентам в зависимости от параметров подписки.
    - `units` - мера величины, хорошо бы иметь тоже набор. (кг, гр, мг, л, мл, стакан, ст. ложка, ч.ложка? :D)

```json
{
    'id': 0,
    'name': '',
    'description': '',
    'img_url': '',
    'cousine_type': 'FROM_PREDEFINED_SET',
    'contains': ['FROM_PREDEFINED_SET'],
    'calories': 0,
    'steps':[
        {
            'title': '',
            'text': '',
            'ingredients':[
                {
                    'name': '',
                    'countable': true,
                    'amount': 1,
                    'units': 'FROM_PREDEFINED_SET'
                },
                {
                    'name': '',
                    'countable': false,
                }
            ]
        }
    ]
}

В такой реализации рецепта, не указан полный список продуктов для приготовления. В такой реализации чтобы получить список для закупки нужно обойти все шаги и суммировать все ингредиенты. Это конечно неудобно, но отражает специфику приготовления разного объема еды. Можно реализовать со списком всех ингредиентов в корне сущности, а описание рецепта просто оставить статичным, мол, сами умножайте.
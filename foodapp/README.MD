# FOODAPP - Flask based web-app for data

Реализует API доступ к данным посредством POST запросов.
Данные в запросе ожидаются в формате JSON, поэтому любой запрос к API необходимо осуществлять с заголовком 'Content-Type: application/json'
В каждом запросе в JSON ОБЯЗАТЕЛЬНО должно быть поле `bot_token` в формате `string`. В будущем будет хранить токен для аутентификации запросов бота. Пока содержимое поля не верифицируется, можно туда писать просто `'123'`

## `/api/registerUser`

Ожидает следующий JSON:

| Имя поля | Тип значения | Обязательный | Описание |
| --- | --- | --- | --- |
| `bot_token` | `string` | да | |
| `chat_id` | `int` | да | идентификатор чата пользователя в Телеграме |
| `firstname` | `str` | да | имя пользователя |
| `lastname` | `str` | да | фамилия пользователя |
| `phone` | `str` | да | номер телефона пользователя |

В результате запроса выдает:

| Имя поля | Тип значения  |  Описание |
| --- | --- | --- |
| `id` | `int` | идентификатор нового пользователя в базе данных (нет необходимости хранить) |

## `/api/getUser`

Ожидает следующий JSON:

| Имя поля | Тип значения | Обязательный | Описание |
| --- | --- | --- | --- |
| `bot_token` | `string` | да | |
| `chat_id` | `int` | да | идентификатор чата пользователя в Телеграме |

В результате запроса выдает:

| Имя поля | Тип значения  |  Описание |
| --- | --- | --- |
| `id` | `int` | идентификатор пользователя в базе данных, либо 0 - если пользователь не найден |

## `/api/addSubscription`

Ожидает следующий JSON:

| Имя поля | Тип значения | Обязательный | Описание |
| --- | --- | --- | --- |
| `bot_token` | `string` | да | |
| `chat_id` | `int` | да | идентификатор чата пользователя в Телеграме, для кого оформляется подписка |
| `cousine_type` | `string` | да | тип кухни, должно быть значением из списка доступных |
| `allergies` | `List[string]` | да | список аллергий, может быть пустым. Строки в списке должны быть из списка доступных |
| `num_persons` | `int` | нет | количество персон, по умолчанию 4 |
| `num_servings` | `int` | нет | количество рационов, по умолчанию 6 |
| `plan` | `int` | да | количество месяцев в подписке |

В результате запроса выдает:

| Имя поля | Тип значения  |  Описание |
| --- | --- | --- |
| `id` | `int` | id подписки в базе данных (нет необходимости хранить) |

## `/api/getSubscriptions`

Ожидает следующий JSON:

| Имя поля | Тип значения | Обязательный | Описание |
| --- | --- | --- | --- |
| `bot_token` | `string` | да | |
| `chat_id` | `int` | да | идентификатор чата пользователя в Телеграме |

В результате запроса выдает:

| Имя поля | Тип значения  |  Описание |
| --- | --- | --- |
| `subs` | `List[JSON]` | Список подписок пользователя, либо пустой список если подписок нет |

JSON схема одной подписки в списке:

| Имя поля | Тип значения  |  Описание |
| --- | --- | --- |
| `id` | `int` | идентификатор подписки в базе данных |
| `chat_id` | `int` | идентификатор владельца подписки |
| `cousine_type` | `string` | тип кухни |
| `allergies` | `List[string]` | список аллергий |
| `num_persons` | `int` | количество персон |
| `num_servings` | `int` | количество рационов |
| `acquired_on` | `int` | unix время оформления подписки |
| `expires_on` | `int` | unix время окончания срока действия подписки |